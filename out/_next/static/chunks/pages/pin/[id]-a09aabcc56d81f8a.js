(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1170],{90687:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pin/[id]",function(){return t(38174)}])},38174:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var i=t(85893),a=t(50101),s=t(2917),r=t(67294),l=t(66835),d=t(11163),o=t(94720),c=t(73804),u=t(97449),m=t(47296),h=t(69077),f=t(81997),p=t(25675),x=t.n(p);let b=e=>{let{pinId:n}=e,{address:t,isConnected:a}=(0,h.mA)(),{allBoards:p,savePinModalOpen:b,setSavePinModalOpen:g,setLoadSavePinTransaction:v}=(0,s.m)(),j=(0,d.useRouter)(),[w,N]=(0,r.useState)(null),y=null!=n?n:j.query.id,_=(0,o.p)(),{data:S,status:A,writeAsync:C}=(0,h.GG)({address:"0x".concat("bb19cbB272cDb3867adAD194ACA58005D419306a"),abi:u.Mt,functionName:"savePinToBoard"}),{data:B}=(0,h.do)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:m.Mt,functionName:"getAllPins",onSuccess(e){let n=e.find(e=>Number(e.id)===Number(y));N(null!=n?n:null)}}),k=async e=>{g(!1),w?await C({args:[e,w.id,w.title,w.description,w.imageHash,w.owner]}).then(()=>{var e;v(null!==(e=Number(w.id))&&void 0!==e?e:0)}).catch(e=>{H("Transaction rejected")}):H("Pin not found!"),j.push("/home")};function H(e,n){_({position:"top",render:()=>(0,i.jsx)(f.F,{text:e,imageHash:n})})}return(0,i.jsx)(l.Z,{isOpen:b,closeModal:()=>g(!1),title:"Save to board",height:"h-full",children:(0,i.jsx)(c.aV,{children:p.map(e=>{var n;return(0,i.jsx)(c.HC,{onClick:()=>k(Number(e.id)),children:(0,i.jsxs)("div",{className:"flex items-center h-16",children:[""!=e.boardCoverHash?(0,i.jsx)(x(),{className:"w-14 h-14 rounded-xl",src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e.boardCoverHash),alt:"board",width:100,height:100}):(0,i.jsx)(i.Fragment,{children:(null===(n=e.pins)||void 0===n?void 0:n.length)>0&&e.pins[0].imageHash?(0,i.jsx)(x(),{className:"w-14 h-14 rounded-xl",src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e.pins[0].imageHash),alt:"board",width:100,height:100}):(0,i.jsx)("div",{className:"bg-gray-200 w-14 h-14 rounded-xl"})}),(0,i.jsx)("div",{className:"justify-center ml-4",children:(0,i.jsx)("h2",{className:"text-lg font-bold",children:e.name})})]})},Number(e.id))})})})};var g=t(14225),v=t(9008),j=t.n(v),w=t(98531);function N(){var e,n,t,l;let{address:c,isConnected:p}=(0,h.mA)(),v=(0,d.useRouter)(),[N,y]=(0,r.useState)(),[_,S]=(0,r.useState)(),{downloadPin:A,setDownloadPin:C,setSavePinModalOpen:B}=(0,s.m)(),[k,H]=(0,r.useState)(null),[E,I]=(0,r.useState)(!1),P=(0,o.p)(),[D,F]=(0,r.useState)(null),{data:q,error:T}=(0,h.do)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:m.Mt,functionName:"getPinById",enabled:!!v.query.id,args:[null!==(e=v.query.id)&&void 0!==e?e:""],onSuccess(e){y(e)}}),{data:M,error:R}=(0,h.do)({address:"0x".concat("bb19cbB272cDb3867adAD194ACA58005D419306a"),abi:u.Mt,functionName:"getBoardById",enabled:!!v.query.boardId,args:[null!==(n=v.query.boardId)&&void 0!==n?n:""],onSuccess(e){S(e)}}),{data:z}=(0,h.do)({address:"0x".concat("9ff82F92B2D3859278EedE1C5e2BF04a9b0E80e9"),abi:w.Mt,functionName:"getUserByAddress",enabled:!!(null==N?void 0:N.owner),args:[null==N?void 0:N.owner],onError(e){L("User not found")}});async function U(e,n){let t=await fetch("https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e)),a=await t.blob(),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(s),C(!1),P({position:"top",render:()=>(0,i.jsx)(f.F,{text:"Image downloading..."})})}function L(e,n){P({position:"top",render:()=>(0,i.jsx)(f.F,{text:e,imageHash:n})})}return(0,h.y2)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:m.Mt,eventName:"CreatedPinEdited",listener(e){let n=e[0].args,t={...N,title:n.newTitle,description:n.newDescription,imageHash:n.imageHash};y(t);let i="Pin "+n.newTitle+" edited!";L(i,n.imageHash)}}),(0,r.useEffect)(()=>{let e=setTimeout(()=>{p||v.push("/")},2e3);if(_&&_.owner!==c&&v.push("/profile"),v.query.boardId||(null==N?void 0:N.owner)===c?I(!0):I(!1),z){let e=z.userAddress.substring(0,6)+"..."+z.userAddress.substring(z.userAddress.length-4,z.userAddress.length);F({userAddress:e,name:z.name,profileImageHash:z.profileImageHash})}return N&&A&&U(N.imageHash,N.title),()=>{clearTimeout(e)}},[v.query,A,c,p,_,N,z]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(j(),{children:(0,i.jsx)("title",{children:"Detail"})}),(0,i.jsxs)("main",{className:"flex flex-col min-h-screen overflow-auto bg-black mb-18",children:[(0,i.jsx)(a.x,{isBoard:!1,isSavedPin:E,isProfile:!1,pin:N}),N?(0,i.jsxs)("div",{className:"",children:[(0,i.jsx)(x(),{src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(null==N?void 0:N.imageHash),alt:null!==(t=null==N?void 0:N.title)&&void 0!==t?t:"Pin image",className:"object-cover w-full rounded-tl-3xl rounded-tr-3xl ",width:100,height:100}),(0,i.jsxs)("div",{className:"p-4 bg-zinc-800 rounded-bl-3xl rounded-br-3xl",children:[D&&(0,i.jsxs)("div",{className:"flex items-center gap-3 mb-4",onClick:()=>v.push("/profile/".concat(N.owner)),children:[""!==D.profileImageHash?(0,i.jsx)(x(),{src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(D.profileImageHash),alt:null!==(l=D.name)&&void 0!==l?l:"Profile image",className:"w-10 h-10 rounded-full",width:100,height:100}):(0,i.jsx)("div",{className:"w-10 h-10 rounded-full bg-zinc-600"}),(0,i.jsx)("p",{className:"text-sm font-semibold",children:""!=D.name?D.name+" - "+D.userAddress:D.userAddress})]}),(0,i.jsx)("h1",{className:"text-2xl font-semibold",children:null==N?void 0:N.title}),(0,i.jsx)("p",{children:null==N?void 0:N.description}),(0,i.jsxs)("div",{className:"flex flex-row justify-center gap-4 mt-6",children:[(0,i.jsx)(g.z,{width:"30%",borderRadius:"50px",colorScheme:"tertiary",variant:"solid",onClick:()=>L("View function not implemented yet"),children:"View"}),(0,i.jsx)(g.z,{width:"30%",borderRadius:"50px",colorScheme:E?"secondary":"primary",variant:"solid",onClick:()=>{var e;return e=Number(N.id),void(E||(H(e),B(!0)))},children:E?"Saved":"Save"})]})]})]}):(0,i.jsx)("div",{className:"flex flex-col items-center justify-center h-full",children:(0,i.jsx)("p",{className:"text-2xl font-semibold",children:"Loading..."})})]}),(0,i.jsx)(b,{pinId:k})]})}},14225:function(e,n,t){"use strict";t.d(n,{z:function(){return x}});var i=t(67294),[a,s]=(0,t(55227).k)({strict:!1,name:"ButtonGroupContext"}),r=t(16914),l=t(25432),d=t(85893);function o(e){let{children:n,className:t,...a}=e,s=(0,i.isValidElement)(n)?(0,i.cloneElement)(n,{"aria-hidden":!0,focusable:!1}):n,o=(0,l.cx)("chakra-button__icon",t);return(0,d.jsx)(r.m.span,{display:"inline-flex",alignSelf:"center",flexShrink:0,...a,className:o,children:s})}o.displayName="ButtonIcon";var c=t(81136);function u(e){let{label:n,placement:t,spacing:a="0.5rem",children:s=(0,d.jsx)(c.$,{color:"currentColor",width:"1em",height:"1em"}),className:o,__css:u,...m}=e,h=(0,l.cx)("chakra-button__spinner",o),f="start"===t?"marginEnd":"marginStart",p=(0,i.useMemo)(()=>({display:"flex",alignItems:"center",position:n?"relative":"absolute",[f]:n?a:0,fontSize:"1em",lineHeight:"normal",...u}),[u,n,f,a]);return(0,d.jsx)(r.m.div,{className:h,...m,__css:p,children:s})}u.displayName="ButtonSpinner";var m=t(81103),h=t(16554),f=t(27440),p=t(33179),x=(0,h.G)((e,n)=>{let t=s(),a=(0,f.mq)("Button",{...t,...e}),{isDisabled:o=null==t?void 0:t.isDisabled,isLoading:c,isActive:h,children:x,leftIcon:g,rightIcon:v,loadingText:j,iconSpacing:w="0.5rem",type:N,spinner:y,spinnerPlacement:_="start",className:S,as:A,...C}=(0,p.Lr)(e),B=(0,i.useMemo)(()=>{let e={...null==a?void 0:a._focus,zIndex:1};return{display:"inline-flex",appearance:"none",alignItems:"center",justifyContent:"center",userSelect:"none",position:"relative",whiteSpace:"nowrap",verticalAlign:"middle",outline:"none",...a,...!!t&&{_focus:e}}},[a,t]),{ref:k,type:H}=function(e){let[n,t]=(0,i.useState)(!e),a=(0,i.useCallback)(e=>{e&&t("BUTTON"===e.tagName)},[]);return{ref:a,type:n?"button":void 0}}(A),E={rightIcon:v,leftIcon:g,iconSpacing:w,children:x};return(0,d.jsxs)(r.m.button,{ref:(0,m.qq)(n,k),as:A,type:null!=N?N:H,"data-active":(0,l.PB)(h),"data-loading":(0,l.PB)(c),__css:B,className:(0,l.cx)("chakra-button",S),...C,disabled:o||c,children:[c&&"start"===_&&(0,d.jsx)(u,{className:"chakra-button__spinner--start",label:j,placement:"start",spacing:w,children:y}),c?j||(0,d.jsx)(r.m.span,{opacity:0,children:(0,d.jsx)(b,{...E})}):(0,d.jsx)(b,{...E}),c&&"end"===_&&(0,d.jsx)(u,{className:"chakra-button__spinner--end",label:j,placement:"end",spacing:w,children:y})]})});function b(e){let{leftIcon:n,rightIcon:t,children:i,iconSpacing:a}=e;return(0,d.jsxs)(d.Fragment,{children:[n&&(0,d.jsx)(o,{marginEnd:a,children:n}),i,t&&(0,d.jsx)(o,{marginStart:a,children:t})]})}x.displayName="Button"}},function(e){e.O(0,[260,4617,5937,9866,1450,6932,3673,2707,101,9774,2888,179],function(){return e(e.s=90687)}),_N_E=e.O()}]);