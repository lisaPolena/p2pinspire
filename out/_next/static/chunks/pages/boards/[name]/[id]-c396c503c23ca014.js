(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3404],{34825:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/boards/[name]/[id]",function(){return s(2859)}])},39119:function(e,t,s){"use strict";s.d(t,{Z:function(){return P}});var i=s(85893),a=s(67294),n=s(66835),r=s(2917),l=s(94720),d=s(33090),o=s(57169),c=s(11978),m=s(73804),h=s(47296),x=s(69077),u=s(80549),b=s(22338),p=s(61329),f=s(57747),j=s(55281),g=s(17745),N=s(60155),w=s(8193);function v(e){let{handleUpload:t,isLoading:s}=e;return(0,i.jsx)(b.W,{children:(0,i.jsx)(p.o,{width:"50",ratio:1,children:(0,i.jsx)(f.xu,{borderColor:"gray.300",borderStyle:"dashed",borderWidth:"2px",rounded:"md",shadow:"sm",role:"group",transition:"all 150ms ease-in-out",_hover:{shadow:"md"},as:g.E.div,initial:"rest",animate:"rest",whileHover:"hover",children:(0,i.jsxs)(f.xu,{position:"relative",height:"100%",width:"100%",children:[(0,i.jsx)(f.xu,{position:"absolute",top:"0",left:"0",height:"100%",width:"100%",display:"flex",flexDirection:"column",children:(0,i.jsxs)(j.K,{height:"100%",width:"100%",display:"flex",alignItems:"center",justify:"center",spacing:"4",children:[(0,i.jsx)(f.xu,{height:"12",width:"12",position:"relative"}),s?(0,i.jsxs)("div",{className:"flex flex-col items-center m-auto",children:[(0,i.jsx)(w.xz6,{size:50,className:"animate-spin"}),(0,i.jsx)("h2",{className:"mt-4 text-lg font-bold",children:"Uploading..."})]}):(0,i.jsxs)("div",{className:"flex flex-col items-center m-auto",children:[(0,i.jsx)(N.v8B,{size:50,className:"animate-bounce"}),(0,i.jsx)("h2",{className:"mt-4 text-base",children:"Upload Image here"})]})]})}),(0,i.jsx)(d.I,{type:"file",height:"100%",width:"100%",position:"absolute",top:"0",left:"0",opacity:"0","aria-hidden":"true",accept:"image/*",onChange:e=>t(e.target.files?e.target.files[0]:null)})]})})})})}var C=s(95410),y=s(81997),I=s(25675),D=s.n(I);let H=e=>{let{boardId:t}=e,[s,b]=(0,a.useState)(""),[p,f]=(0,a.useState)(""),[j,g]=(0,a.useState)(0),[w,I]=(0,a.useState)(""),{allBoards:H,setAllBoards:P,createPinModalOpen:A,setCreatePinModalOpen:B,createdPin:S,setCreatedPin:k}=(0,r.m)(),F=(0,u.g)(),_=(0,l.p)(),[z,E]=(0,a.useState)(!1),[M,T]=(0,a.useState)(!1),{data:V,status:Z,writeAsync:L}=(0,x.GG)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:h.Mt,functionName:"createPin"});(0,a.useEffect)(()=>{if(0===H.length){let e=(0,C.MR)();P(e)}},[H.length]);let O=async()=>{let e=t||j;if(!s||p&&p.length>50||!w||!e){if(!s){q("Title is empty!","");return}if(!w){q("Image is empty!","");return}if(p&&p.length>50){q("Description is longer than 50 Characters!","");return}e||q("No Board selected!","");return}await L({args:[s,p,w,e]}).then(()=>{B(!1),T(!1);let t=H.find(t=>t.id===Number(e));t&&k({boardName:t.name,imageHash:w}),R(),_({position:"top",render:()=>(0,i.jsx)(y.F,{text:"The Pin is being created..."})})}).catch(e=>{B(!1),T(!1),R(),q("Transaction rejected")})};function R(){b(""),f(""),g(0),I("")}let U=async e=>{if(!e)return;E(!0);let t=await F.add(e);E(!1),I(t.path)},G=()=>{B(!1),T(!1),R()};function q(e,t){_({position:"top",render:()=>(0,i.jsx)(y.F,{text:e,imageHash:t})})}return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(n.Z,{isOpen:A,closeModal:()=>G(),title:"Add new Pin",height:"h-[95%]",children:[(0,i.jsx)("div",{className:"absolute top-3 right-3",children:t?(0,i.jsx)("button",{className:"px-4 py-2 text-white transition-colors bg-red-600 rounded-3xl",onClick:O,children:"Create"}):(0,i.jsx)("button",{className:"px-4 py-2 text-white transition-colors bg-red-600 rounded-3xl",onClick:()=>T(!0),children:"Next"})}),(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[w?(0,i.jsx)(D(),{src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(w),className:"object-cover m-auto w-80 h-80 rounded-2xl",alt:"Pin Image",width:100,height:100}):(0,i.jsx)(v,{handleUpload:U,isLoading:z}),(0,i.jsxs)("div",{className:"flex flex-col mx-4",children:[(0,i.jsxs)("div",{className:"mt-4",children:[(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Title"}),(0,i.jsx)(d.I,{variant:"unstyled",placeholder:"Give your Pin a Title",size:"lg",defaultValue:s,onChange:e=>b(e.target.value)})]}),(0,i.jsxs)("div",{className:"mt-6",children:[(0,i.jsx)("p",{className:"text-lg font-semibold",children:"Description"}),(0,i.jsx)(o.g,{variant:"unstyled",placeholder:"Say more about this Pin",size:"lg",defaultValue:p,onChange:e=>f(e.target.value)})]})]})]}),!t&&(0,i.jsx)(c.M,{direction:"right",in:M,style:{zIndex:20},children:(0,i.jsxs)("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-zinc-800 rounded-t-[40px] z-10 h-full",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between gap-24 flex-cols",children:[(0,i.jsx)("button",{className:"text-white",onClick:()=>T(!1),children:(0,i.jsx)(N.dUf,{size:30})}),(0,i.jsx)("button",{className:"px-4 py-2 text-white transition-colors bg-red-600 rounded-3xl",onClick:O,children:"Create"})]}),(0,i.jsx)("div",{className:"flex items-center gap-24 mt-4",children:(0,i.jsx)("h2",{className:"text-base text-white",children:"Your Boards"})}),(0,i.jsx)(m.aV,{children:H.map(e=>{var t;return(0,i.jsx)(m.HC,{onClick:()=>g(Number(e.id)),children:(0,i.jsxs)("div",{className:"flex items-center h-16",children:[""!=e.boardCoverHash?(0,i.jsx)(D(),{className:"w-14 h-14 rounded-xl",src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e.boardCoverHash),alt:"board",width:100,height:100}):(0,i.jsx)(i.Fragment,{children:(null===(t=e.pins)||void 0===t?void 0:t.length)>0&&e.pins[0].imageHash?(0,i.jsx)(D(),{className:"w-14 h-14 rounded-xl",src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e.pins[0].imageHash),alt:"board",width:100,height:100}):(0,i.jsx)("div",{className:"bg-gray-200 w-14 h-14 rounded-xl"})}),(0,i.jsx)("div",{className:"justify-center ml-4",children:(0,i.jsx)("h2",{className:"text-lg font-bold",children:e.name})}),e.id===j&&(0,i.jsx)(N.VQF,{size:30,className:"absolute right-6"})]})},Number(e.id))})})]})})]})})};var P=H},2859:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return I}});var i=s(85893),a=s(50101),n=s(2917),r=s(94720),l=s(81136),d=s(9008),o=s.n(d),c=s(11163),m=s(67294),h=s(69077),x=s(47296),u=s(97449),b=s(60155),p=s(66835),f=s(73804);let j=()=>{let{addModalOpen:e,setAddModalOpen:t,setCreatePinModalOpen:s}=(0,n.m)();return(0,i.jsx)(p.Z,{isOpen:e,isAlternative:!0,closeModal:()=>t(!1),title:"Create",height:"h-[50%]",children:(0,i.jsxs)(f.aV,{children:[(0,i.jsx)(f.HC,{children:(0,i.jsx)("p",{className:"mb-4 text-lg font-bold",children:"Idea Pin"})}),(0,i.jsx)(f.HC,{onClick:()=>s(!0),children:(0,i.jsx)("p",{className:"mb-4 text-lg font-bold",children:"Pin"})}),(0,i.jsx)("h2",{className:"mt-10 mb-4 text-sm text-white",children:"Add"}),(0,i.jsx)(f.HC,{children:(0,i.jsx)("p",{className:"mb-4 text-lg font-bold",children:"Section"})}),(0,i.jsx)(f.HC,{children:(0,i.jsx)("p",{className:"mb-4 text-lg font-bold",children:"Collaborator"})}),(0,i.jsx)(f.HC,{children:(0,i.jsx)("p",{className:"mb-4 text-lg font-bold",children:"Note"})})]})})};var g=s(39119),N=s(95410),w=s(81997),v=s(2337),C=s(25675),y=s.n(C);function I(){var e;let{address:t,isConnected:s}=(0,h.mA)(),[d,p]=(0,m.useState)(null),[f,C]=(0,m.useState)(!1),I=(0,c.useRouter)(),[D,H]=(0,m.useState)([]),[P,A]=(0,m.useState)([]),[B,S]=(0,m.useState)(!0),{allBoards:k,setAllBoards:F,boardView:_,setAddModalOpen:z}=(0,n.m)(),E=(0,r.p)(),{data:M}=(0,h.do)({address:"0x".concat("bb19cbB272cDb3867adAD194ACA58005D419306a"),abi:u.Mt,functionName:"getBoardById",args:[I.query.id],onSuccess(e){p(e)},onError(e){e.message.includes("Board does not exist.")&&(R("Board does not exist."),I.push("/profile"))}}),{data:T}=(0,h.do)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:x.Mt,functionName:"getAllPins",onSuccess(e){A(e)}});(0,h.y2)({address:"0x".concat("bb19cbB272cDb3867adAD194ACA58005D419306a"),abi:u.Mt,eventName:"BoardEdited",listener(e){let t=e[0].args,s={id:t.boardId,name:t.newName,description:t.newDescription,owner:t.owner,pins:t.pins,boardCoverHash:t.boardCoverHash};p(s),O(Number(t.boardId),t.newName,t.newDescription,t.boardCoverHash);let i=t.newName+" edited!";R(i,"")}}),(0,h.y2)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:x.Mt,eventName:"PinDeleted",listener(e){let t=e[0].args;V(Number(t.pinId),Number(t.boardId)),R("Pin deleted!","")}}),(0,h.y2)({address:"0x".concat("bb19cbB272cDb3867adAD194ACA58005D419306a"),abi:u.Mt,eventName:"SavedPinDeleted",listener(e){let t=e[0].args;V(Number(t.pinId),Number(t.boardId)),R("Pin deleted!","")}}),(0,h.y2)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:x.Mt,eventName:"PinCreated",listener(e){let t=e[0].args;Z(Number(t.pinId),t.title,t.description,t.imageHash,Number(t.boardId),t.owner)}}),(0,h.y2)({address:"0x".concat("55706B2c62cbdda9317343A7290F0bD54e70cCf3"),abi:x.Mt,eventName:"CreatedPinEdited",listener(e){var t;let s=e[0].args,i=null!==(t=s.newBoardId)&&void 0!==t?t:s.oldBoardId;L(Number(s.pinId),s.newTitle,s.newDescription,s.imageHash,Number(i));let a="Pin "+s.newTitle+" edited!";R(a,s.imageHash)}}),(0,m.useEffect)(()=>{let e=setTimeout(()=>{s||I.push("/")},2e3);if(function(){if(M&&d&&T){let e=d.pins.map(e=>e),t=P.filter(t=>e.find(e=>Number(e)===Number(t.id))),s=P.filter(e=>e.boardId===d.id),i=[...t,...s];H(i),S(!1)}}(),0===k.length){let e=(0,N.MR)();F(e)}d&&d.owner!==t&&(I.push("/home"),(0,N._R)());let i=()=>{let e=window.scrollY;C(e>0)};return window.addEventListener("scroll",i),()=>{clearTimeout(e),window.removeEventListener("scroll",i)}},[I.query,d,T,M,s,t]);let V=(e,t)=>{H(t=>t.filter(t=>{let{id:s}=t;return Number(s)!==e}));let s=k.map(s=>s.id===t?{...s,pins:s.pins.filter(t=>Number(t.id)!==e)}:s);F(s),(0,N.o6)(s)},Z=(e,t,s,i,a,n)=>{let r={id:e,title:t,description:s,imageHash:i,boardId:a,owner:n};H(e=>[...e.filter(e=>{let{id:t}=e;return Number(t)!==Number(a)}),r].sort((e,t)=>Number(e.id)-Number(t.id)));let l=k.map(e=>e.id===a?{...e,pins:[...e.pins,r]}:e);F(l),(0,N.o6)(l)},L=(e,t,s,i,a)=>{H(n=>{let r=n.map(n=>Number(n.id)===e?{...n,title:t,description:s,imageHash:i,boardId:a}:n);return r.sort((e,t)=>Number(e.id)-Number(t.id))})},O=(e,t,s,i)=>{let a=k.map(a=>a.id===e?{...a,name:t,description:s,boardCoverHash:i}:a);F(a),(0,N.o6)(a)};function R(e,t){E({position:"top",render:()=>(0,i.jsx)(w.F,{text:e,imageHash:t})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(o(),{children:(0,i.jsx)("title",{children:"Detail"})}),(0,i.jsxs)("main",{className:"min-h-screen overflow-auto bg-black mb-18",children:[(0,i.jsx)(a.x,{isBoard:!0,isSavedPin:!1,isProfile:!1,title:d?d.name:"",showTitle:f,board:d,pins:D}),d?(0,i.jsxs)("div",{className:"relative top-[50px]",children:[(0,i.jsxs)("div",{className:"mt-10 mb-10 text-center",children:[(0,i.jsx)("h1",{className:"text-3xl font-bold text-white mx-auto break-normal max-w-[20rem]",children:null!==(e=d.name)&&void 0!==e?e:""}),d.description&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("hr",{className:"w-2/4 m-auto mt-4"}),(0,i.jsx)("div",{className:"px-6 mt-4",children:(0,i.jsx)("p",{className:"text-sm text-tertiary",children:d.description})})]})]}),B?(0,i.jsx)("div",{className:"flex items-center justify-center h-[60vh]",children:(0,i.jsx)(l.$,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)("p",{className:"text-[1.2rem] ml-[1.3rem] mb-[0.4rem] font-semibold",children:D&&D.length?D.length+" Pins":"0 Pins"})}),(0,i.jsx)(v.Z,{columnsCount:"wide"===_?1:"compact"===_?3:2,gutter:"20px",className:"px-4 mt-2 relative top-[50px] mb-32",children:D.map(e=>(0,i.jsxs)("div",{className:"h-auto",onClick:()=>I.push("/pin/".concat(e.id,"?boardId=").concat(d.id)),children:[(0,i.jsx)(y(),{src:"https://web3-pinterest.infura-ipfs.io/ipfs/".concat(e.imageHash),alt:e.title,className:"object-cover w-full rounded-2xl ".concat("wide"===_?"max-h-96":"compact"===_?"max-h-40":"max-h-72"),width:100,height:100}),(0,i.jsx)("div",{className:"mb-2",children:(0,i.jsx)("h2",{className:"pt-2 pl-2 text-white font-semibold text-[0.9rem]",children:e.title})})]},e.id))})]})]}):(0,i.jsx)(l.$,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"blue.500",size:"xl"}),(0,i.jsx)("button",{onClick:()=>z(!0),className:"flex fixed w-[50px] h-[50px] rounded-full bottom-5 left-[45vw] bg-secondary items-center justify-center",children:(0,i.jsx)(b.xcL,{color:"white",size:30})})]}),(0,i.jsx)(j,{}),(0,i.jsx)(g.Z,{boardId:d?Number(d.id):null})]})}}},function(e){e.O(0,[260,4617,5937,9866,1450,6932,8524,3673,2707,101,9774,2888,179],function(){return e(e.s=34825)}),_N_E=e.O()}]);